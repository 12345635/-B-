(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-045efdca"],{c7ab:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"add-product",staticClass:"add-product"},[r("div",[r("a-steps",{attrs:{current:t.current}},t._l(t.steps,(function(t){return r("a-step",{key:t.title,attrs:{title:t.title}})})),1),r("div",{staticClass:"steps-content"},[0==t.current?r("GoodsDetail"):t._e(),1==t.current?r("GoodsSaleDetail",{on:{onSubmit:t.onSubmit}}):t._e()],1)],1)])},o=[],i=r("5530"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[r("a-form-model-item",{attrs:{label:"标题",prop:"title",required:"",validateField:""}},[r("a-input",{attrs:{value:t.form.title},on:{change:function(e){return t.edit("title",e.target.value)}}})],1),r("a-form-model-item",{attrs:{label:"商品描述",prop:"desc"}},[r("a-input",{attrs:{value:t.form.desc},on:{change:function(e){return t.edit("desc",e.target.value)}}})],1),r("a-form-model-item",{attrs:{label:"商品类目",prop:"category",required:""}},[r("a-select",{attrs:{value:t.form.category,placeholder:"请选择商品类目"},on:{change:function(e){return t.edit("category",e)}}},t._l(t.productTypeList,(function(e){return r("a-select-option",{key:e.id,attrs:{value:e.id},on:{change:function(e){return t.edit("desc",e.target.value)}}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),r("a-form-model-item",{attrs:{"wrapper-col":{span:12,offset:7},prop:"c_items"}},[r("a-select",{attrs:{placeholder:"请选择所属子类目",value:t.form.c_items?t.form.c_items:t.form.c_item},on:{change:function(e){return t.edit("c_items",e)}}},[t._l(t.c_items,(function(e){return r("a-select-option",{key:e,attrs:{value:e}},[t._v(" "+t._s(e)+" ")])}))],2)],1),r("a-form-model-item",{attrs:{label:"商品标签",prop:"tags",required:""}},[r("a-select",{attrs:{mode:"tags",value:t.form.tags,placeholder:"选择标签"},on:{change:function(e){return t.edit("tags",e)}}},t._l(t.tags,(function(e,a){return r("a-select-option",{key:a,attrs:{value:e}},[t._v(" "+t._s(e)+" ")])})),1)],1),r("a-form-model-item",{attrs:{"wrapper-col":{span:24,offset:10}}},[0==t.current?r("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v(" 下一页 ")]):t._e()],1)],1)},s=[],u=r("5880"),c={data:function(){return{labelCol:{span:7},wrapperCol:{span:12},tags:["包邮，最晚次日达"],other:"",rules:{}}},computed:Object(i["a"])(Object(i["a"])({},Object(u["mapState"])("product",["productTypeList","current","form"])),{},{c_items:function(){return this.form.category?this.productTypeList[this.form.category-1].c_items:[]}}),created:function(){this.$store.dispatch("product/getProductTypeList")},methods:{onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return console.log("error submit!!"),!1;t.$store.commit("product/setCurrent",t.current+1)}))},edit:function(t,e){this.$store.commit("product/setForm",{key:t,value:e})}}},l=c,p=r("2877"),d=Object(p["a"])(l,n,s,!1,null,null,null),m=d.exports,f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[r("a-form-model-item",{attrs:{label:"商品售价",prop:"price",required:""}},[r("a-input",{attrs:{value:t.form.price},on:{change:function(e){return t.edit("price",e.target.value)}}})],1),r("a-form-model-item",{attrs:{label:"商品折扣价",prop:"price_off"}},[r("a-input",{attrs:{value:t.form.price_off},on:{change:function(e){return t.edit("price_off",e.target.value)}}})],1),r("a-form-model-item",{attrs:{label:"商品库存",prop:"inventory"}},[r("a-input",{attrs:{value:t.form.inventory},on:{change:function(e){return t.edit("inventory",e.target.value)}}})],1),r("a-form-model-item",{attrs:{label:"计量单位",prop:"unit",required:""}},[r("a-input",{attrs:{value:t.form.unit},on:{change:function(e){return t.edit("unit",e.target.value)}}})],1),r("a-form-model-item",{attrs:{label:"上架状态",prop:"status"}},[r("a-radio-group",{attrs:{name:"radioGroup","default-value":"1"==t.form.status?t.form.status:0}},[r("a-radio",{attrs:{value:1},on:{change:function(e){return t.edit("status",1)}}},[t._v(" 上架 ")]),r("a-radio",{attrs:{value:0},on:{change:function(e){return t.edit("status",0)}}},[t._v(" 下架")])],1)],1),r("a-form-model-item",{attrs:{label:"商品相册",prop:"images"}},[r("div",{staticClass:"clearfix"},[r("a-upload",{attrs:{action:"https://mallapi.duyiedu.com/upload/images?appkey="+t.$store.state.isLogin.cookie.appkey,"list-type":"picture-card","file-list":t.fileList,name:"avatar"},on:{preview:t.handlePreview,change:t.handleChange}},[t.fileList.length<8?r("div",[r("a-icon",{attrs:{type:"plus"}}),r("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1):t._e()]),r("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.handleCancel}},[r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.previewImage}})])],1)]),r("a-form-model-item",{attrs:{"wrapper-col":{span:24,offset:10}}},[t.current>0?r("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.prev}},[t._v(" 上一页 ")]):t._e(),t.current==t.steps.length-1?r("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v(" 提交 ")]):t._e()],1)],1)},h=[],v=r("1da1");r("96cf"),r("d3b7"),r("d81d");function g(t){return new Promise((function(e,r){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){return e(a.result)},a.onerror=function(t){return r(t)}}))}var b={data:function(){return{labelCol:{span:7},wrapperCol:{span:12},rules:{},previewVisible:!1,previewImage:""}},computed:Object(i["a"])(Object(i["a"])({},Object(u["mapState"])("product",["current","steps","form"])),{},{fileList:function(){var t=[];return this.form.images.length>=1&&(t=this.form.images.map((function(t,e){return{uid:e,name:"image.png",status:"done",url:t}}))),t}}),created:function(){this.$store.dispatch("product/getProductTypeList")},methods:{onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return console.log("error submit!!"),!1;t.$emit("onSubmit")}))},handleCancel:function(){this.previewVisible=!1},handlePreview:function(t){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.url||t.preview){r.next=4;break}return r.next=3,g(t.originFileObj);case 3:t.preview=r.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return r.stop()}}),r)})))()},handleChange:function(t){var e=t.file,r=t.fileList;e.status,"done"===e.status?(this.$message.success("上传成功"),e.url=e.response.data.url,e.thumbUrl=e.response.data.thumbUrl,this.form.images.push(e.url)):this.fileList=r},edit:function(t,e){this.$store.commit("product/setForm",{key:t,value:e})},prev:function(){this.$store.commit("product/setCurrent",this.current-1)},next:function(){this.$store.commit("product/setCurrent",this.current+1)}}},_=b,y=Object(p["a"])(_,f,h,!1,null,null,null),w=y.exports,$={computed:Object(u["mapState"])("product",["steps","current"]),components:{GoodsDetail:m,GoodsSaleDetail:w},data:function(){return{form:{title:"",desc:"",category:null,c_items:"",tags:[],price:"",price_off:"",unit:null,inventory:"",status:null,images:[]}}},methods:{onSubmit:function(){var t=this;if(this.$route.params.id)this.$api.Edit(this.$store.state.product.form).then((function(){t.$store.dispatch("product/getProductList",{page:1,size:10,searchWord:"",category:null}),t.$router.push("/list"),t.$store.commit("product/setCurrent",0)}),(function(t){alert(t)}));else for(var e in this.$store.state.product.form){if(!this.$store.state.product.form[e])return;this.$api.Add(this.$store.state.product.form).then((function(){t.$store.dispatch("product/getProductList",{page:1,size:10,searchWord:"",category:null}),t.$router.push("/list").catch((function(){})),t.$store.commit("product/setCurrent",0)}),(function(t){alert(t)}))}},isEdit:function(){var t=this;this.$route.params.id?this.$api.product(this.$route.params.id).then((function(e){var r=e.data;for(var a in r)t.$store.dispatch("product/setProduct",{key:a,value:r[a]})}),(function(t){alert(t)})):this.$store.dispatch("product/resetProduct",Object(i["a"])({},this.form))}},created:function(){this.isEdit()},watch:{$route:function(t){this.isEdit()}}},C=$,k=Object(p["a"])(C,a,o,!1,null,"3654f615",null);e["default"]=k.exports},d81d:function(t,e,r){"use strict";var a=r("23e7"),o=r("b727").map,i=r("1dde"),n=i("map");a({target:"Array",proto:!0,forced:!n},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);